<h1 class="mb-4">üìî Carnet de bord pratique</h1>

<p class="lead">Imprime des fiches de r√©vision condens√©es au format poche apr√®s chaque module valid√©.</p>

<div class="row mb-5">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">üéì Fiches disponibles</h5>
            </div>
            <div class="card-body">
                <p class="text-muted">Modules valid√©s : {{completedModulesCount}}/{{totalModulesCount}}</p>
                <div class="list-group">
                    {{#modules}}
                    {{#isCompleted}}
                    <a href="#fiche-{{id}}" class="list-group-item list-group-item-action">
                        ‚úÖ {{name}}
                    </a>
                    {{/isCompleted}}
                    {{^isCompleted}}
                    <span class="list-group-item text-muted">
                        üîí {{name}} (√Ä compl√©ter)
                    </span>
                    {{/isCompleted}}
                    {{/modules}}
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">üìã Imprimer</h5>
            </div>
            <div class="card-body">
                <p>S√©lectionne les fiches √† imprimer :</p>
                <form>
                    {{#modules}}
                    {{#isCompleted}}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="fiche-check-{{id}}" value="{{id}}" checked>
                        <label class="form-check-label" for="fiche-check-{{id}}">
                            {{name}}
                        </label>
                    </div>
                    {{/isCompleted}}
                    {{/modules}}
                </form>
                <button class="btn btn-info mt-3 w-100" onclick="printSelectedFiches()">
                    üñ®Ô∏è Imprimer les fiches s√©lectionn√©es
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Fiches (masqu√©es, affich√©es √† la demande) -->
<div id="fiches-content">
    {{#modules}}
    {{#isCompleted}}
    <div id="fiche-{{id}}" class="fiche-printable mb-5 p-4" style="page-break-after: always; border: 1px solid #ddd; background: white;">
        <h3 class="mb-2">{{name}}</h3>
        <p class="text-muted small"><strong>Module {{moduleNumber}}</strong> ‚Ä¢ {{description}}</p>
        
        <hr class="my-2">
        
        <h6><strong>Objectifs cl√©s</strong></h6>
        <ul class="small mb-3">
            {{#objectifs}}
            <li>{{.}}</li>
            {{/objectifs}}
        </ul>

        <h6><strong>Points √† retenir</strong></h6>
        <ul class="small mb-3">
            {{#keyPoints}}
            <li>{{.}}</li>
            {{/keyPoints}}
        </ul>

        <h6><strong>Formules/Concepts</strong></h6>
        <pre class="small bg-light p-2 rounded">de>{{formulas}}</code></pre>

        <hr class="my-2">
        <p class="text-muted tiny"><small>Carnet de bord - Pr√©paration PE - NDC</small></p>
    </div>
    {{/isCompleted}}
    {{/modules}}
</div>

<script>
function printSelectedFiches() {
    const selected = [];
    document.querySelectorAll('.form-check-input:checked').forEach(checkbox => {
        selected.push(checkbox.value);
    });
    if(selected.length === 0) {
        alert('S√©lectionne au moins une fiche');
        return;
    }
    // Affiche les fiches s√©lectionn√©es et lance l'impression
    window.print();
}
</script>

<style media="print">
    nav, footer, .form-check, .btn { display: none; }
    body { background: white; }
</style>
